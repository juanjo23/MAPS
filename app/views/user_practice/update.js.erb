function append_element(source, element_name) {
  //var last_element = find_last_element();
  var new_element = cli.append(source, 'bpmn:Task', '150,0');
  cli.setLabel(new_element, element_name);
  resize_canvas();
  save_diagram(new_element);
}

function save_diagram(final_element){
  bpmnjs.saveXML(function(err, xml){
    $.ajax({
      url: "/user_practice",
      type: "POST",
      data: {xml_diagram: xml, fe:final_element},
      success: function(resp){ console.log("Diagram saved"); }
    });
  });
}

<% source = @company.final_element %> //Last task added
<% practice_name = @current_user_practice.practice.name %>  //Nombre de la pr치ctica a a침adir
<% answer = @current_user_practice.answer %>  //Respuesta
<% id = @current_user_practice.id %>  //Id
<% @progress = @current_user_practice.practice.progress %>  //Id


<% if UserPractice.exists?(id + 1) %>
  <% @current_user_practice = UserPractice.find(id + 1)%>
<% else %>
  <% @current_user_practice = nil %>
<% end %>

//Get the next practice
$('#cuestionario').fadeOut(400, function(){
  //Animation complete
  $('#cuestionario').html("<%= escape_javascript(render('cuestionario')) %>");
  $('#cuestionario').fadeIn();
  setRatyStar();
});


//A침adiendo la pr치ctica al diagrama
<% if answer == 3 %>
  append_element('<%= source %>', '<%= practice_name %>');
<% end %>
